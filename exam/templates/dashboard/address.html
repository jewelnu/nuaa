{% extends 'common_code/base.html' %}
{% load static %}
{% block title %}Address{% endblock %}
{% block extra_css %}
<link href="https://stackpath.bootstrapcdn.com/bootstrap/5.1.3/css/bootstrap.min.css" rel="stylesheet">
{% endblock %}

{% block content %}
<div class="container mt-5">
    <h2>Address Job Form</h2>
    <form method="post">
        {% csrf_token %}
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="mb-0">Present Address Information</h5>
            </div>
            <div class="card-body">   
                <div class="row"> 
                    <div class="mb-3 col-md-4">
                        <label for="id_present_address" class="form-label">Present Address</label>
                        {{ form.present_address }}
                    </div>
                    
                    <div class="mb-3 col-md-3">
                        <label for="id_present_dist" class="form-label">Present District</label>
                        <select name="present_dist" id="id_present_dist" class="form-select" required>
                            <option value="">Select District</option>
                            {% for district in districts %}
                                <option value="{{ district.id }}">{{ district.district }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    
                    <div class="mb-3 col-md-3">
                        <label for="id_present_upozilla" class="form-label">Present Upozilla</label>
                        <select name="present_upozilla" id="id_present_upozilla" class="form-select" required>
                            <option value="">Select Upozilla</option>
                            {% for upozilla in form.present_upozilla.field.queryset %}
                                <option value="{{ upozilla.id }}">{{ upozilla.upozilla }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
            </div>
        </div>
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="mb-0">Permanent Address Information</h5>
            </div>
            <div class="card-body">    
                <div class="row">
                    <div class="mb-3 col-md-4">
                        <label for="id_permanent_address" class="form-label">Permanent Address</label>
                        {{ form.permanent_address }}
                    </div>
                    
                    <div class="mb-3 col-md-3">
                        <label for="id_permanent_dist" class="form-label">Permanent District</label>
                        <select name="permanent_dist" id="id_permanent_dist" class="form-select" required>
                            <option value="">Select District</option>
                            {% for district in districts %}
                                <option value="{{ district.id }}">{{ district.district }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    
                    <div class="mb-3 col-md-3">
                        <label for="id_permanent_upozilla" class="form-label">Permanent Upozilla</label>
                        <select name="permanent_upozilla" id="id_permanent_upozilla" class="form-select" required>
                            <option value="">Select Upozilla</option>
                            {% for upozilla in form.permanent_upozilla.field.queryset %}
                                <option value="{{ upozilla.id }}">{{ upozilla.upozilla }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
            </div>
        </div>
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="mb-0">Work Address Information</h5>
            </div>
            <div class="card-body"> 
                <div class="row">
                    <div class="mb-3 col-md-4">
                        <label for="id_work_address" class="form-label">Work Address</label>
                        {{ form.work_address }}
                    </div>
                    
                    <div class="mb-3 col-md-3">
                        <label for="id_work_dist" class="form-label">Work District</label>
                        <select name="work_dist" id="id_work_dist" class="form-select" required>
                            <option value="">Select District</option>
                            {% for district in districts %}
                                <option value="{{ district.id }}">{{ district.district }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    
                    <div class="mb-3 col-md-3">
                        <label for="id_work_upozilla" class="form-label">Work Upozilla</label>
                        <select name="work_upozilla" id="id_work_upozilla" class="form-select" required>
                            <option value="">Select Upozilla</option>
                            {% for upozilla in form.work_upozilla.field.queryset %}
                                <option value="{{ upozilla.id }}">{{ upozilla.upozilla }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
            </div>
        </div>
                <button type="submit" class="btn btn-primary">Submit</button>
            </form>
        </div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script type="text/javascript">
    $(document).ready(function() {
        // Load upozillas for present address
        $('#id_present_dist').change(function() {
            var districtId = $(this).val();
            $.ajax({
                url: '{% url "load_upozillas" %}',
                data: {
                    'district_id': districtId
                },
                success: function(data) {
                    $('#id_present_upozilla').html('<option value="">Select Upozilla</option>');
                    $.each(data, function(key, value) {
                        $('#id_present_upozilla').append($('<option>', { 
                            value: value.id,
                            text: value.upozilla 
                        }));
                    });
                }
            });
        });

        // Load upozillas for permanent address
        $('#id_permanent_dist').change(function() {
            var districtId = $(this).val();
            $.ajax({
                url: '{% url "load_upozillas" %}',
                data: {
                    'district_id': districtId
                },
                success: function(data) {
                    $('#id_permanent_upozilla').html('<option value="">Select Upozilla</option>');
                    $.each(data, function(key, value) {
                        $('#id_permanent_upozilla').append($('<option>', { 
                            value: value.id,
                            text: value.upozilla 
                        }));
                    });
                }
            });
        });

        // Load upozillas for work address
        $('#id_work_dist').change(function() {
            var districtId = $(this).val();
            $.ajax({
                url: '{% url "load_upozillas" %}',
                data: {
                    'district_id': districtId
                },
                success: function(data) {
                    $('#id_work_upozilla').html('<option value="">Select Upozilla</option>');
                    $.each(data, function(key, value) {
                        $('#id_work_upozilla').append($('<option>', { 
                            value: value.id,
                            text: value.upozilla 
                        }));
                    });
                }
            });
        });
    });
</script>
{% endblock %}
